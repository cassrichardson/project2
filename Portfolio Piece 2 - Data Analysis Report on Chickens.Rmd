---
title: "Portfolio 2"
author: "Cassandra Richardson"
date: "4/30/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(ggplot2)
library(dplyr)
library(tidyverse)
```

# **Cassandra Richardson's Portfolio Piece #2 - Data Analysis Report on Chicken Weight and Diet**



# Step 1: Finding a dataset.

### R has several built-in datasets that we can use to practice R functions with. To view these datasets, simply use the function below: 

```{r finding dataset}
data()
```

### After looking at the built-in datasets, I've decided that I want to use "ChickenWeight."

# Step 2: Before we begin any analyses, let's examine what this dataset includes:

```{r exploring chickens}
#View(ChickWeight)
#?ChickWeight
```

### The "view()" function opens the full dataset file in a new tab, so we can visually examine what the data looks like. The ?ChickenWeight function opens a help file that explains what this built-in dataset covers. 

### The help window tells us that "ChickenWeight" examines the weight versus age of chicken on different diets. This dataset contains 578 rows and 4 columns based on an experiment on the effect of diet on early growth of chicks. 

# Step 3: Let's explore some characteristics about the data:

```{r data characteristics}
glimpse(ChickWeight)
head(ChickWeight)
names(ChickWeight)
missing <- !complete.cases(ChickWeight)
ChickWeight[missing]
```

### - glimpse() shows us an overview of the whole dataset. We see that there are 578 rows and 4 columns, just like the help window told us.
### - head() gives us the first 6 rows of data
### - names() tells us all of the variable names: "weight" "Time" "Chick" "Diet"  
### - missing <- !complete.cases() creates an object/tibble called "missing" with any missing observations across the entire dataset
### - ChickWeight[missing] shows us that the "missing" tibble has 0 columns. This means that there was no missing data in this dataset, which makes it easier to work with! 

# Step 4: For the sake of practice, let's see what our data would look like in a wider format.

```{r pivot wide}
chickens_wide <- ChickWeight |> 
  pivot_wider(id_cols = c(Time, Chick), 
              names_from = Diet, 
              values_from = weight)

head(chickens_wide)
```

### In the code above, we did a univariate pivot to make our original dataset wider such that the column for diet (diet 1-4) was split into four columns for each type of diet, and weight was moved to the appropriate diet for each chick and time point. However, this format is harder to interpret and includes many missing variables. Moving forward, we won't use the "chicken_wide" data, and instead we will use the original "ChickWeight."

# Step 5: Let's get some basic descriptive statistics about each variable. 


```{r descriptives}
chicken_data <- ChickWeight

summary <- summary(chicken_data)

print(summary)
```

### The table printed above gives us a summary of descriptive statistics for all variables. 


# Step 6: Let's get the weight of the chickens for each of the four diets:

```{r chicken diets}
chicken_diets <- chicken_data |>
  group_by(Diet)|>
  summarize(
    mean = mean(weight),
    sd = sd(weight),
    min = min(weight),
    max = max(weight)
  )

print(chicken_diets)
```

### In the code above, I used dplyr's "group_by()" function to say that I want to group the descriptives into each of the four chicken diets. After the data is grouped by diet, I found the mean, sd, min, and max chicken weights for each diet. It looks like diet 1 had the lowest mean weight, whereas diet 3 had the highest mean weight. 

# Step 7: Let's make a bar graph to better visualize the chickens' weight by diet! 

```{r bar graph}
ggplot(chicken_data) +
  aes(x = Diet, y = weight) +
  geom_bar(stat = "summary", fun = "mean")
```

### Now we have a very simple bar graph to represent the mean weight of the chickens at each of the 4 diets! This basic graph uses the ggplot2 package with Diet on the x axis and weight on the y axis. I added (stat = "summary", fun = "mean") to tell R that I don't want the values to be the total count of weights for each diet, but rather the mean weight of each diet. Although this graph gets the job done, let's make this graph look a little better:

# Step 8: Making a better bar graph:

```{r better bar graph}
ggplot(chicken_data) +
  aes(x = Diet, y = weight, color = Diet, fill = Diet) +
  geom_bar(stat = "summary", fun = "mean") +
  labs(
    title = "Chick Weight by Diet",
    tag = "Figure 1",
    x = "Diet",
    y = "Weight"
)
```

# Step 9: Conduct a one-way Analysis of Variance (ANOVA) test to see if the is a statistically significant difference between the avergae weights of the chicken in the four diet groups. 

```{r anova}
anova <- aov(weight ~ Diet, data = chicken_data)

anova_output <- summary(anova)

print(anova_output)
```

### A one-way ANOVA with type of diet (1, 2, 3, 4) as the between-subjects factor. There was sufficient evidence to conclude that type of diet had an effect on the weight of the chickens, *F* (3, 574) = 10.81, *p* < .001. 

# Step 10: Since there are more than two levels of the IV (Diet), we need to run post-hoc tests to see which diets are significantly different from each other. 

```{r post hoc}
TukeyHSD(anova)
```

### Post hoc tests using a Tukey's HSD adjustment indicated that chickens weighed significantly more on diet 3 (*M* = 143, *SD* = 86.5) than on diet 2 (*M* = 123, *SD* = 71.6) or diet 1 (*M* = 103, *SD* = 56.7). 

# *Final Step: Present the findings:*

## A one-way ANOVA with type of diet (1, 2, 3, 4) as the between-subjects factor. There was sufficient evidence to conclude that type of diet had an effect on the weight of the chickens, *F* (3, 574) = 10.81, *p* < .001.Post hoc tests using a Tukey's HSD adjustment indicated that chickens weighed significantly more on diet 3 (*M* = 143, *SD* = 86.5) than on diet 2 (*M* = 123, *SD* = 71.6) or diet 1 (*M* = 103, *SD* = 56.7). These results are displayed in Figure 1. 

## This data came from "ChickWeight" as one of R's built-in datasets available for public use. Unfortunately, the description of the dataset did not include what each diet consisted of, so we cannot make any inferences about the application of our findings. 




